<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MovieFlip</title>
  <link rel="preconnect" href="https://image.tmdb.org" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="app-shell">
    <header class="top-bar">
      <div>
        <h1>MovieFlip</h1>
        <p id="appSubtitle">Swipe your taste. Get better recommendations.</p>
      </div>
      <div class="top-controls">
        <button id="langEnBtn" class="lang-btn" type="button" aria-label="Switch to English">🇬🇧</button>
        <button id="langDeBtn" class="lang-btn" type="button" aria-label="Auf Deutsch wechseln">🇩🇪</button>
        <button id="restartFlippingBtn" class="top-restart-btn" type="button">Restart Flipping</button>
        <select id="audienceFilterSelect" class="audience-filter" aria-label="Audience filter">
          <option value="all">All</option>
          <option value="kids">Kids</option>
          <option value="family">Family</option>
          <option value="adults">Adults</option>
        </select>
        <button id="providersBtn" class="settings-btn" type="button" aria-label="Open providers">
          <span id="providersBtnLabel">TV</span>
          <span id="providersCountBadge" class="icon-badge" hidden>0</span>
        </button>
        <button id="settingsBtn" class="settings-btn" type="button" aria-label="Open settings">⚙</button>
      </div>
    </header>

    <section class="dashboard">
      <div class="counter-box">
        <strong id="flipCounter">0</strong>
        <span id="flipLabel">Flips completed</span>
      </div>
      <div class="counter-box">
        <strong id="likesCounter">0</strong>
        <span id="likesLabel">Likes</span>
      </div>
      <div class="counter-box">
        <strong id="watchedCounter">0</strong>
        <span id="watchedLabel">Watched</span>
      </div>
      <div class="counter-box">
        <strong id="dislikesCounter">0</strong>
        <span id="dislikesLabel">Dislikes</span>
      </div>
    </section>

    <section class="flip-layout">
      <section class="card-stage">
        <article class="movie-card" id="movieCard">
          <div class="poster-wrap">
            <img id="moviePoster" alt="Movie poster" />
          </div>
        </article>
        <p class="empty-note" id="emptyNote" hidden>No movies left in queue. Loading more...</p>
      </section>

      <section class="detail-panel">
      <section class="actions">
        <button class="action-btn back" id="backBtn">Back</button>
        <button class="action-btn dislike" id="dislikeBtn">Dislike</button>
        <button class="action-btn like" id="likeBtn">Like</button>
        <button class="action-btn skip" id="skipBtn">Skip</button>
        <button class="action-btn watched" id="watchedBtn">Watched</button>
        <button class="action-btn bookmark" id="bookmarkBtn">Bookmark</button>
      </section>
        <div class="card-body">
          <div class="movie-title-row">
            <h2 id="movieTitle">Load a movie</h2>
            <div class="movie-title-links">
              <a id="movieTrailerLink" class="inline-icon-link trailer" target="_blank" rel="noreferrer" aria-label="Watch trailer" hidden>▶</a>
              <a id="movieTmdbLink" class="inline-icon-link tmdb" target="_blank" rel="noreferrer" aria-label="Open on TMDB" hidden>🔗</a>
            </div>
          </div>
          <p id="movieMeta"></p>
          <p class="meta-label" id="movieDescriptionLabel">Description</p>
          <p id="movieOverview"></p>
          <p class="meta-label" id="movieKeywordsLabel">Keywords</p>
          <div class="genre-list" id="genreList"></div>
        </div>
      </section>
    </section>

    <section class="recommendations" id="recommendationsSection" hidden>
      <div class="recommendations-head">
        <h2 id="recsTitle">Recommended for You</h2>
        <button id="refreshRecsBtn">Refresh</button>
      </div>
      <div id="recommendationsGrid" class="recommendations-grid"></div>
    </section>

    <section class="watched-panel">
      <div class="watched-head">
        <h2 id="libraryTitle">Your Movie Library</h2>
        <div class="library-controls">
          <label for="bookmarkSortSelect" id="bookmarkSortLabel" class="bookmark-sort-label" hidden>Sort</label>
          <select id="bookmarkSortSelect" hidden>
            <option value="date_desc">Newest</option>
            <option value="date_asc">Oldest</option>
            <option value="title_asc">Title A-Z</option>
            <option value="title_desc">Title Z-A</option>
          </select>
          <button id="clearLibraryBtn" type="button">Clear Current</button>
        </div>
      </div>
      <div class="library-tabs">
        <button type="button" class="library-tab active" data-view="watched">Watched</button>
        <button type="button" class="library-tab" data-view="bookmarks">Bookmarked</button>
        <button type="button" class="library-tab" data-view="likes">Liked</button>
        <button type="button" class="library-tab" data-view="dislikes">Disliked</button>
      </div>
      <p id="libraryHint">Ratings improve your recommendation profile.</p>
      <div id="libraryList" class="watched-list"></div>
    </section>
  </main>

  <section class="settings-modal hidden" id="settingsModal" aria-hidden="true">
    <div class="settings-backdrop" id="settingsBackdrop"></div>
    <div class="settings-card" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <div class="settings-head">
        <h2 id="settingsTitle">Settings</h2>
        <button id="closeSettingsBtn" class="settings-close" type="button" aria-label="Close settings">x</button>
      </div>
      <p id="settingsInfo">Enter your free TMDB API key (read access token) to load movies.</p>
      <div class="config-row">
        <input id="apiKeyInput" type="password" placeholder="TMDB Bearer token" autocomplete="off" />
        <button id="saveApiKeyBtn">Save Key</button>
      </div>
      <small id="settingsHelp">
        Get one at <a href="https://www.themoviedb.org/settings/api" target="_blank" rel="noreferrer">themoviedb.org</a>. Store it with domain restrictions when possible.
      </small>
    </div>
  </section>

  <section class="settings-modal hidden" id="confirmModal" aria-hidden="true">
    <div class="settings-backdrop" id="confirmBackdrop"></div>
    <div class="settings-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <div class="settings-head">
        <h2 id="confirmTitle">Confirm</h2>
      </div>
      <p id="confirmMessage">Really remove this item?</p>
      <div class="config-row">
        <button id="confirmCancelBtn" type="button">Cancel</button>
        <button id="confirmOkBtn" class="remove-watched-btn" type="button">Remove</button>
      </div>
    </div>
  </section>

  <section class="settings-modal hidden" id="providersModal" aria-hidden="true">
    <div class="settings-backdrop" id="providersBackdrop"></div>
    <div class="settings-card" role="dialog" aria-modal="true" aria-labelledby="providersTitle">
      <div class="settings-head">
        <h2 id="providersTitle">Providers</h2>
        <button id="closeProvidersBtn" class="settings-close" type="button" aria-label="Close providers">x</button>
      </div>
      <p id="providersInfo">Select streaming providers for recommendation filtering.</p>
      <div id="providersList" class="providers-list"></div>
      <div class="config-row">
        <button id="clearProvidersBtn" type="button">Clear</button>
        <button id="saveProvidersBtn" type="button">Save</button>
      </div>
    </div>
  </section>

  <template id="libraryItemTemplate">
    <div class="watched-item">
      <span class="watched-title">
        <span class="watched-title-text"></span>
        <span class="watched-title-meta" hidden></span>
      </span>
      <div class="watched-actions">
        <div class="watched-inline-icons">
          <a class="inline-icon-link trailer" target="_blank" rel="noreferrer" aria-label="Watch trailer" hidden>▶</a>
          <a class="inline-icon-link imdb" target="_blank" rel="noreferrer" aria-label="Open on IMDb" hidden>IMDb</a>
          <a class="inline-icon-link availability" target="_blank" rel="noreferrer" aria-label="Availability">TV</a>
        </div>
        <div class="rating-group"></div>
        <details class="item-menu">
          <summary class="item-menu-trigger">•••</summary>
          <div class="item-menu-panel"></div>
        </details>
      </div>
    </div>
  </template>

  <template id="recCardTemplate">
    <article class="rec-card">
      <div class="rec-media">
        <img class="rec-poster" alt="Recommended poster" />
        <div class="rec-links">
          <a class="rec-link trailer" target="_blank" rel="noreferrer" aria-label="Watch trailer">▶</a>
          <a class="rec-link tmdb" target="_blank" rel="noreferrer" aria-label="Open on TMDB">🔗</a>
        </div>
        <div class="rec-actions">
          <button class="rec-action like" type="button">Like</button>
          <button class="rec-action dislike" type="button">Dislike</button>
          <button class="rec-action watched" type="button">Watched</button>
        </div>
        <div class="rec-actions-bottom">
          <button class="rec-action bookmark" type="button">Bookmark</button>
        </div>
      </div>
      <div class="rec-body">
        <h3 class="rec-title"></h3>
        <p class="rec-meta"></p>
      </div>
    </article>
  </template>

  <script src="app.js" type="module"></script>
</body>
</html>
